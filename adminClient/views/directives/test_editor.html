{{data}}
<tabset>
    <tab heading="Content">
        <h1 class="editable" contenteditable ng-model="data.title" ng-text="true"></h1>

        <div ng-repeat="element in data.content track by $index">
            <button ng-click="deleteElement($index)">Delete</button>
            <button ng-if="!$first" ng-click="moveElementUp($index)">Up</button>
            <button ng-if="!$last" ng-click="moveElementDown($index)">Down</button>
            <button ng-if="data.content[$index].data.id!=undefined" ng-click="makeQuestionLocal($index)">Edit</button>
            <br>
            <question-editor ng-if="data.content[$index].type=='question'"
                             ng-disabled="data.content[$index].data.id!=undefined" inline="true"
                             data="data.content[$index].data"></question-editor>
            <test-text-editor ng-if="data.content[$index].type=='text'"
                              data="data.content[$index].data"></test-text-editor>

        </div>
        <div>
            <button ng-click="addTextElement()">Add text element</button>
            <button ng-click="addNewQuestionElement()">Add new question</button>
            <button ng-click="addExistingQuestionElement()">Add exisisting question</button>
        </div>
    </tab>
    <tab heading="Answers">
    <div ng-repeat="question in data.content | filter: {'type':'question'}">
        <h4>Question {{$index+1}}</h4>
        <choice-question-answer-editor ng-if="question.data.type=='choice'" data="question.data" ng-disabled="question.data.id"></choice-question-answer-editor>
        <multiplechoice-question-answer-editor ng-if="question.data.type=='multiplechoice'" data="question.data" ng-disabled="question.data.id"></multiplechoice-question-answer-editor>
        <open-question-answer-editor ng-if="question.data.type=='open'" data="question.data" ng-disabled="question.data.id"></open-question-answer-editor>
    </div>
    </tab>
    <tab heading="Feedback">
        <h2>Default feedback</h2>
        <label>Wrong</label><br>
        <div class="editable" contenteditable ng-model="data.default_feedback.wrong"></div>
        <br>
        <label>Right</label><br>
        <div class="editable" contenteditable ng-model="data.default_feedback.right"></div>
        <h2>Question feedback</h2>
        <div ng-repeat="question in data.content | filter: {'type':'question'}">
            <h4>Question {{$index+1}}</h4>
            <label>Wrong</label>
             <a href="" ng-click="insertTestDefaultFeedback($index, 'wrong')">Insert test default</a>
             <a href="" ng-click="insertQuestionDefaultFeedback($index, 'wrong')" ng-if="data.content[questionToContentIndex($index)].data.feedback['wrong']">Insert question default</a><br>
            <div class="editable" contenteditable ng-model="data.question_feedback[$index].wrong"></div>
            <label>Right</label>
             <a href="" ng-click="insertTestDefaultFeedback($index, 'right')">Insert test default</a>
            <a href="" ng-click="insertQuestionDefaultFeedback($index, 'right')"  ng-if="data.content[questionToContentIndex($index)].data.feedback['right']">Insert question default</a><br>
            <div class="editable" contenteditable ng-model="data.question_feedback[$index].right"></div>
        </div>
        <h2>Score feedback</h2>
        <div ng-repeat="total_feedback in data.total_feedback">
            <label>From</label>
            <select ng-model="total_feedback.min" ng-disabled="true">
                <option ng-repeat="option in getTotalFeedbackRange($index, true)">{{option}}</option>
            </select>
            <label>To</label>
            <select ng-model="total_feedback.max"  ng-change="onTotalFeedbackRangeChange($index, false)" ng-disabled="$index == data.total_feedback.length-1">
                <option ng-repeat="option in getTotalFeedbackRange($index, false)" ng-value="option">{{option}}</option>
            </select>
            <a href="" ng-click="removeTotalFeedback($index)">Remove</a>
            <div class="editable" contenteditable ng-model="total_feedback.feedback"></div>
        </div>
        <a href="" ng-click="addTotalFeedback()" ng-if="data.total_feedback.length <= data.question_feedback.length">Add feedback option</a>
    </tab>
    <tab heading="Planning">
        <form class="form-horizontal">
            <div class="form-group">
                <label for="is_template" class="col-sm-2 control-label">Is template</label>
                <div class="col-sm-10">
                    <div class="checkbox">
                        <label><input type="checkbox" class="" id="is_template" ng-model="data.is_template" />&NonBreakingSpace;</label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="open_at" class="col-sm-2 control-label">Open at</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" datetime-picker ng-min="now" ng-model="data.open_at" id="open_at" />
                    <a href="" ng-click="openTest()" class="btn btn-default">Open now</a>
                </div>
            </div>
            <div class="form-group">
                <label for="close_at" class="col-sm-2 control-label">Close at</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" datetime-picker ng-min="data.open_at" ng-model="data.close_at" id="close_at" />
                    <a href="" ng-click="closeTest()" class="btn btn-default">Close now</a>
                </div>
            </div>
            <div class="form-group">
                <label for="feedback_timing" class="col-sm-2 control-label">Feedback timing</label>
                <div class="col-sm-10">
                    <select class="form-control" ng-model="data.feedback_timing" id="feedback_timing">
                        <option value="never">Never send feedback</option>
                        <option value="at">Send feedback at</option>
                        <option value="after">Send feedback after</option>
                    </select>
                </div>
            </div>
            <div ng-if="data.feedback_timing=='at'" class="form-group">
                <label for="feedback_at" class="col-sm-2 control-label">Feedback at</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" datetime-picker ng-min="data.close_at" ng-model="data.feedback_at" id="feedback_at" />
                </div>
            </div>
            <div ng-if="data.feedback_timing=='after'" class="form-group">
                <label for="feedback_after" class="col-sm-2 control-label">Feedback after</label>
                <div class="col-sm-10">
                    <input type="number" class="form-control" ng-model="data.feedback_after" id="feedback_after" /> minutes
                </div>
            </div>
            <div class="form-group">
                <label for="invite_method" class="col-sm-2 control-label">Invite method</label>
                <div class="col-sm-10">
                    <select class="form-control" ng-model="data.invite_method" id="invite_method">
                        <option value="link">Using a link to request an access-code</option>
                        <option value="email">By sending an e-mail with an access-code</option>
                        <option value="code">By providing the an access-code manually</option>
                        <option value="login">By logging in</option>
                        <option value="secure">By using an secure access-code</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="invite_url" class="col-sm-2 control-label">Invite URL</label>
                <div class="col-sm-10">
                    <div id="invite_url" class="form-control-static">{{data.invite_url}}</div>
                </div>
            </div>
        </form>

    </tab>
    <tab heading="Results">

    </tab>
    <tab heading="Permissions">
    </tab>

</tabset>