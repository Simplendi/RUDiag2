<tabset>
    <tab heading="Content">
        <label>Type</label><br>
        <select ng-model="data.type" ng-disabled="disabled">
            <option value="choice">Choice</option>
            <option value="multiplechoice">Multiple choice</option>
            <option value="open">Open</option>
        </select>
        <br>
        <choice-question-editor ng-if="data.type=='choice'" ng-disabled="disabled" data="data"></choice-question-editor>
        <multiplechoice-question-editor ng-if="data.type=='multiplechoice'" ng-disabled="disabled"
                                        data="data"></multiplechoice-question-editor>
        <open-question-editor ng-if="data.type=='open'" ng-disabled="disabled" data="data"></open-question-editor>
    </tab>
    <tab ng-if="!inline" heading="Answers">
        <choice-question-answer-editor ng-if="data.type=='choice'" ng-disabled="disabled" data="data"></choice-question-answer-editor>
        <multiplechoice-question-answer-editor ng-if="data.type=='multiplechoice'" ng-disabled="disabled" data="data"></multiplechoice-question-answer-editor>
    </tab>
    <tab ng-if="!inline" heading="Feedback">
        <label>Wrong</label><br>

        <div class="editable" contenteditable ng-model="data.feedback.wrong"></div>
        <br>

        <label>Right</label><br>

        <div class="editable" contenteditable ng-model="data.feedback.right"></div>
    </tab>
    <tab heading="Metadata">
        <div ng-if="loadingMetadata">
            Loading the metadata list
        </div>
        <div ng-if="!loadingMetadata">
            <table class="table">
                <thead>
                <tr>
                    <th class="col-md-6">Metadata</th>
                    <th class="col-md-6">Value</th>
                </tr>
                </thead>
                <tbody ng-repeat="(name, values) in data.metadata | orderBy: 'name'">
                <tr ng-repeat="value in values track by $index">
                    <td>{{name}}</td>
                    <td>
                        <input ng-if="getMetadataByName(name).type=='text' || getMetadataByName(name).type=='url'"
                               ng-model="data.metadata[name][$index]"
                               type="text"
                               class="form-control"
                               style="width:80%; display:inline-block"/>
                        <ui-select ng-if="getMetadataByName(name).type=='tree'"
                                   ng-model="data.metadata[name][$index]"
                                   theme="bootstrap"
                                   style="width:80%; display:inline-block">
                            <ui-select-match placeholder="Enter metadata value">
                                {{$select.selected.description}}
                            </ui-select-match>
                            <ui-select-choices
                                    repeat="option.value as option in getMetadataByName(name).options | filter: $select.search">
                                {{option.description}}
                            </ui-select-choices>
                        </ui-select>
                        <a href="" ng-click="deleteMetadataValue(name, $index)" class="btn btn-default">Delete</a>
                    </td>
                </tr>
                <tr ng-if="getMetadataByName(name).multivalue">
                    <td>
                        {{name}}
                    </td>
                    <td>
                        <a href="" ng-click="addMetadataValue(name)" class="btn btn-default">Add</a>
                    </td>
                </tr>
                </tbody>
                <tbody>
                <tr>
                    <td>
                        <ui-select ng-model="newMetadata.name" theme="bootstrap">
                            <ui-select-match allow-clear="true" placeholder="Enter metadata to add">
                                {{$select.selected.name}}
                            </ui-select-match>
                            <ui-select-choices
                                    repeat="metadata.name as metadata in metadata | filter: filterMetadataNames | filter: $select.search">
                                {{metadata.name}}
                            </ui-select-choices>
                        </ui-select>
                    </td>
                    <td>
                        <a href="" ng-click="addMetadata()" class="btn btn-default">Add</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </tab>
    <tab ng-if="!inline" heading="Permissions">
        <div ng-if="loadingUsers">
            Loading the user list
        </div>
        <div ng-if="!loadingUsers">
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-sm-2 control-label">Owners</label>

                    <div class="col-sm-10">
                        <div class="row" ng-repeat="owner_id in data.owners track by $index">
                            <div class="form-control-static col-sm-5">{{getUserById(owner_id).fullname}}
                                ({{getUserById(owner_id).username}})
                            </div>
                            <a href="" class="btn btn-default" ng-if="canRemoveOwner(owner_id)"
                               ng-click="deleteOwner($index)">Delete</a>
                        </div>
                        <div class="row">
                            <ui-select class="col-sm-5" ng-model="newOwner.id" theme="bootstrap">
                                <ui-select-match allow-clear="true" placeholder="Enter user to add">
                                    {{$select.selected.fullname}} ({{$select.selected.username}})
                                </ui-select-match>
                                <ui-select-choices repeat="user.id as user in users | filter: filterOwners">
                                    {{user.fullname}} ({{user.username}})
                                </ui-select-choices>
                            </ui-select>
                            <a href="" ng-click="addOwner()" class="btn btn-default">Add</a>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </tab>

</tabset>